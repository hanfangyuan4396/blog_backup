---
title: 树莓派4B无显示器安装Raspberry Pi 系统与无线SSH登录
date: 2020-07-06 22:09:17
tags: 
    - 树莓派
    - 系统安装
---

# 1. 下载镜像及工具软件
## 下载镜像
Raspberry Pi OS 镜像: [https://www.raspberrypi.org/downloads/raspberry-pi-os/](https://www.raspberrypi.org/downloads/raspberry-pi-os/) 官网会非常慢 可以用清华的镜像源 [https://mirrors.tuna.tsinghua.edu.cn/raspberry-pi-os-images/raspios_armhf/images/raspios_armhf-2020-05-28/2020-05-27-raspios-buster-armhf.zip](https://mirrors.tuna.tsinghua.edu.cn/raspberry-pi-os-images/raspios_armhf/images/raspios_armhf-2020-05-28/2020-05-27-raspios-buster-armhf.zip) (对应官网的
Raspberry Pi OS (32-bit) with desktop版本)
<!-- more -->
## 下载工具
推荐官方的工具[Raspberry Pi Imager](https://www.raspberrypi.org/downloads/)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706193320135.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
此软件不仅可以烧录系统还可以格式化SD卡，十分方便。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706193739341.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)

# 2. 烧录
> 需要准备读卡器和一张SD卡，最好大于等于8GB

## 格式化
如果SD卡之前被用过特别是烧录了其他系统，需要格式化一下SD卡，使用刚才下载的工具软件Raspberry Pi Imager即可。
1. 先通过读卡器把SD卡插到电脑
2. 打开Raspberry Pi Imager软件，最左边选择ERASE,中间选择插入的SD卡![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706194745931.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
3. 点击WRITE即可进行格式化，稍等片刻就会完成
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706194847308.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
## 烧录系统
1. 把刚刚下载的系统镜像文件进行解压，得到 .img文件
2. 同样用Raspberry Pi Imager软件，但最左边选择Use custom,并选择刚刚解压的镜像文件，中间选择要烧录的SD卡
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020070619541819.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706195605450.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
3.点击write即可进行烧录，该过程包括烧录和校验两个阶段，一般需要持续几分钟
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706195727622.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
烧录阶段
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706195751531.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
校验阶段
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706200145619.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
3. 镜像烧录校验成功后会出现以下界面
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706200606461.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
>ps:烧录后你可能会发现SD卡容量只剩252MB，这是正常现象，因为windows只能识别FAT分区
# 3. 无线SSH登录配置
烧录完成之后先别急着拔卡，还需要做以下配置
## SSH配置
因为新版树莓派默认没有SSH，需要在SD卡的根目录创建名为"SSH"（注意无后缀名）空文件
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706205957411.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
## WiFi配置
同样在SD卡根目录下创建名为"wpa_supplicant.conf"文件，文件输入以下内容，为了防止windows自带的记事本出现编码问题，推荐使用notepad++编辑([notepad++下载](https://notepad-plus-plus.org/downloads/))。可以写入多个无线网络的配置，其中priority代表连接的优先级，数值越大优先级越高。
```ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
ap_scan=1
fast_reauth=1
country=CN
network={
	ssid="要连接的WiFi1 名字"
	psk="要连接的WiFi1 密码"
	priority=5
}
network={
	ssid="要连接的WiFi2 名字"
	psk="要连接的WiFi2 密码"
	priority=4
}
```
> 以上SSH以及WIFI的配置都是为了下面的无线SSH登录步骤做准备
# 4. 硬件连接与开机
>无线SSH登录方式树莓派的连接非常简单，只需要树莓派板子、电源线以及SD卡。

此时就可以把SD卡从电脑弹出了然后把SD卡从读卡器中取出，将其插入到树莓派背面的SD卡槽上，SD卡金手指面向板子插入。(注意是**把小的SD卡直接插入到树莓派板子**，不是通过读卡器把SD卡插到树莓派的USB接口。别猜了，没错，我一开始就是这么干的。)
然后把电源线连接到树莓派上，开启电源，可以看到红色电源指示灯亮起，绿色指示灯无规律地闪烁，代表系统启动中。
# 5. 无线SSH登录
## 查看树莓派IP地址
确保用来无线SSH登录的电脑和树莓派处在同一局域网下，一般连接同一个路由器的WiFi即可或网线即可。
在路由器的后台管理页面查找是否有名称为raspberrypi的设备并查看其IP地址，如果有，就代表树莓派成功启动并连接上了无线网络。恭喜你，离成功登录树莓派只有一步之遥了。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706214850759.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
## SSH登录
因为win10系统配备了ssh功能，所以win10用户可以直接在命令行输入
`ssh pi@树莓派的IP地址`
其中，pi是树莓派默认的一个用户名，比如根据我刚刚查到的IP地址，我应该输入
`ssh pi@192.168.0.116`
然后提示输入密码，默认是raspberry，即树莓的英文单词。
由于是第一次登录树莓派，会询问是否信任该主机，输入yes即可。
至此，即可完成登录。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706220521242.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
当然也可以用[putty软件](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html)登录，putty使用起来也很简单，网上也有很多教程，就不在此赘述。

# 补充：SSH免密登录
每次输入密码登录其实挺麻烦的，可以通过一些操作实现免密登录
1. 如果在电脑的用户目录存在.ssh文件夹并且里面包括id_rsa与id_rsa.pub两个文件，可以跳过此步骤。在电脑命令行输入 
`ssh-keygen -t rsa`
产生密钥对，一路回车即可。(ssh-keygen这个命令win10可能默认没有，我是安装过git才有的这个命令)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706225028485.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
2. 在命令行进入 .ssh 目录，输入
`scp id_rsa.pub pi@树莓派的IP地址` 
把公钥文件上传到树莓派服务器
3. SSH登录到树莓派，在用户目录下创建 .ssh 文件夹，并输入命令
`cat id_rsa.pub >> ~/.ssh/authorized_keys `
把电脑的公钥添加到树莓派的授权文件中
4. 测试登录
`ssh pi@树莓派的IP地址`
如果操作正确的话，可以直接登录
5. 还可以更加省事，一般路由器分配给树莓派的IP地址是固定的。因此可以一个名为"pi.bat"的批处理文件，文件中输入ssh登录的命令
`ssh pi@树莓派的IP地址`
![在这里插入图片描述](https://img-blog.csdnimg.cn/2020070623014042.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
然后可以在比如E盘中创建一个名为"quickStart"的文件夹，并把这个文件夹添加到系统的path环境变量中，并把pi.bat文件放到这个文件夹，于是你可以用window+R打开运行窗口输入pi或者在命令行里输入pi直接登录到树莓派。
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706230641169.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
![在这里插入图片描述](https://img-blog.csdnimg.cn/20200706230732516.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDM4NzMzOQ==,size_16,color_FFFFFF,t_70)
